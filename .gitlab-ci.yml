image: gcc

ai-build:
    stage: build
    before_script:
        - apt update && apt -y install make autoconf catch
    script:
        - cd ai
        - make release
    artifacts:
        paths:
            - ai/test

ai-test:
    stage: test
    script:
        - ai/test

ai-coverage:
    stage: deploy
    before_script:
        - apt update && apt -y install make autoconf catch lcov
    script:
        - cd ai
        - make coverage
        - ./test
        - gcov -r src/*.cpp
        - cd src
        - lcov --directory . --capture --output-file coverage.info
        - lcov --remove coverage.info -o coverage.info '/usr/include/*'
        - lcov --list coverage.info
